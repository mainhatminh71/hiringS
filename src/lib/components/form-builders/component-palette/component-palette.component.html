<div class="component-palette" [style.background-color]="themeService.currentThemeBackgrounds().sidebar"
  [style.border-right-color]="themeService.currentThemeBackgrounds().border"
  [style.--theme-primary-color]="currentThemeColor" [style.--theme-primary-rgba]="themePrimaryRgba"
  [style.--palette-border-color]="themeService.currentThemeBackgrounds().border"
  [style.--palette-border-soft]="themeService.currentTheme().includes('dark') ? 'rgba(255, 255, 255, 0.08)' : 'rgba(15, 23, 42, 0.08)'"
  [style.--palette-item-bg]="themeService.currentTheme().includes('dark') ? '#111827' : '#ffffff'"
  [style.--palette-item-border]="themeService.currentThemeBackgrounds().border"
  [style.--palette-item-border-soft]="themeService.currentTheme().includes('dark') ? 'rgba(255, 255, 255, 0.12)' : 'rgba(15, 23, 42, 0.10)'"
  [style.--palette-item-text]="themeService.currentTheme().includes('dark') ? '#e5e7eb' : '#374151'"
  [style.--palette-item-hover-bg]="themeService.currentTheme().includes('dark') ? '#1f2937' : '#f3f4f6'">
  <div class="palette-header" [style.background-color]="themeService.currentThemeBackgrounds().sidebar"
    [style.border-bottom-color]="themeService.currentThemeBackgrounds().border">
    <h3 [style.color]="themeService.currentTheme().includes('dark') ? '#e5e7eb' : '#111827'">
      Components
    </h3>
  </div>

  <div class="palette-content">
    <!-- Basic Components -->
    <div class="category-section" *ngIf="blocksByCategory['basic']?.length">
      <h4 [style.color]="themeService.currentTheme().includes('dark') ? '#cbd5f5' : '#6b7280'">Basic</h4>
      <div class="block-list" cdkDropList id="paletteBasic" [cdkDropListSortingDisabled]="true"
        [cdkDropListConnectedTo]="['canvasDropList']">
        <div *ngFor="let block of blocksByCategory['basic']" class="block-item" cdkDrag [cdkDragData]="block">
          <i [class]="block.icon"></i>
          <span>{{ block.displayName }}</span>
        </div>
      </div>
    </div>

    <!-- Advanced Components -->
    <div class="category-section" *ngIf="blocksByCategory['advanced']?.length">
      <h4 [style.color]="themeService.currentTheme().includes('dark') ? '#cbd5f5' : '#6b7280'">Advanced</h4>
      <div class="block-list" cdkDropList id="paletteAdvanced" [cdkDropListSortingDisabled]="true"
        [cdkDropListConnectedTo]="['canvasDropList']">
        <div *ngFor="let block of blocksByCategory['advanced']" class="block-item" cdkDrag [cdkDragData]="block">
          <i [class]="block.icon"></i>
          <span>{{ block.displayName }}</span>
        </div>
      </div>
    </div>

    <!-- Layout Components -->
    <div class="category-section" *ngIf="blocksByCategory['layout']?.length">
      <h4 [style.color]="themeService.currentTheme().includes('dark') ? '#cbd5f5' : '#6b7280'">Layout</h4>
      <div class="block-list" cdkDropList id="paletteLayout" [cdkDropListSortingDisabled]="true"
        [cdkDropListConnectedTo]="['canvasDropList']">
        <div *ngFor="let block of blocksByCategory['layout']" class="block-item" cdkDrag [cdkDragData]="block">
          <i [class]="block.icon"></i>
          <span>{{ block.displayName }}</span>
        </div>
      </div>
    </div>

    <!-- Theme Toggle Button -->
    <div class="theme-toggle-wrapper">
      <button class="theme-toggle-btn" (click)="toggleTheme()" [title]="'Current theme: ' + currentThemeName"
        [style.background-color]="currentThemeColor" [style.border-color]="currentThemeColor">
        <i class="pi pi-palette"></i>
        <span>{{ currentThemeName }}</span>
      </button>
    </div>
  </div>
</div>