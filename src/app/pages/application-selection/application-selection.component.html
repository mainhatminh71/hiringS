<div class="application-selection-page" [class.loaded]="!isLoading">
  <div class="page-container" [class.animate-in]="!isLoading">
    <!-- Header Section -->
    <div class="page-header" [class.animate-in]="!isLoading">
      <div class="header-content" [class.animate-in]="!isLoading">
        <h1 class="page-title">Application Forms</h1>
        <p class="page-subtitle">Create and manage your application forms</p>
        <button 
          nz-button 
          nzType="primary"
          routerLink="/form-generation"
          class="create-button">
          <nz-icon nzType="plus" nzTheme="outline"></nz-icon>
          <span>Create new form</span>
        </button>
      </div>
      
      <div class="header-actions" [class.animate-in]="!isLoading">
        @if (selectedIds.size > 0) {
          <button 
            nz-button 
            nzType="primary" 
            nzDanger 
            (click)="deleteSelected()" 
            class="delete-button">
            <nz-icon nzType="delete" nzTheme="outline"></nz-icon>
            <span>Delete ({{selectedIds.size}})</span>
          </button>
        }
      </div>
    </div>

    <!-- Content Section -->
    @if (isLoading) {
      <div class="loading-container" [class.fade-out]="!isLoading">
        <nz-spin [nzSize]="'large'"></nz-spin>
      </div>
    } @else {
      <div class="cards-grid" [class.animate-in]="!isLoading">
        <!-- Application Forms -->
        @for (app of paginatedApplications; track trackByFormId($index, app)) {
          <app-application-form-card 
            [routerLink]="'/form-generation/' + app.id" 
            [themeColor]="app.themeColor"
            [selectable]="true"
            [selected]="selectedIds.has(app.id)"
            (selectedChange)="toggleSelection(app.id, $event)"
            class="form-card stagger-item"
            [attr.data-index]="$index">
            <div class="form-card-content">
              <div class="form-card-title" [title]="app.name || 'Application Form'">
                {{app.name || 'Application Form'}}
              </div>
              <div class="form-card-meta">
                <span class="meta-item">
                  <nz-icon nzType="file-text" nzTheme="outline"></nz-icon>
                  {{getInstanceCount(app)}} questions
                </span>
              </div>
            </div>
          </app-application-form-card>
        }
      </div>
      
      <!-- Pagination -->
      @if (totalPages > 1) {
        <div class="pagination-container" [class.animate-in]="!isLoading">
          <nz-pagination
            [nzPageIndex]="currentPage"
            [nzTotal]="applications.length"
            [nzPageSize]="pageSize"
            [nzShowSizeChanger]="false"
            [nzShowQuickJumper]="true"
            (nzPageIndexChange)="onPageChange($event)">
          </nz-pagination>
        </div>
      }
    }
  </div>
</div>